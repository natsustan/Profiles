# HTTP(S) and SOCKS4(A)/SOCKS5 server on the same port
mixed-port: 7890

# Set to true to allow connections to the local-end server from
# other LAN IP addresses
allow-lan: true

# Clash router working mode
# rule: rule-based packet routing
# global: all packets will be forwarded to a single endpoint
# direct: directly forward the packets to the Internet
mode: rule

# Clash by default prints logs to STDOUT
# info / warning / error / debug / silent
log-level: info

external-controller: :9090

url-rewrite:
- ^https?:\/\/(www.)?(g|google)\.cn https://www.google.com 302
- ^https?:\/\/(ditu|maps).google\.cn https://maps.google.com 302

dns:
  enable: true
  ipv6: false
  listen: 0.0.0.0:53
  enhanced-mode: redir-host
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
     - '*.lan'
     - localhost.ptlogin2.qq.com
  nameserver:
     - 223.5.5.5
     - 119.29.29.29
     - https://doh.pub/dns-query
     - https://dns.alidns.com/dns-query
  fallback:
     - 8.8.8.8
     - 1.1.1.1
     - tls://1.0.0.1:853
     - tls://dns.google:853
     - https://cloudflare-dns.com/dns-query
     - https://dns.google/dns-query
  fallback-filter:
     geoip: true
     ipcidr:
       - 240.0.0.0/4    

proxies:
  # Trojan
  - name: 🇨🇳 Taiwan | 01
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20011
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇨🇳 Taiwan | 02
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20012
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇨🇳 Taiwan | 03
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20013
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇨🇳 Taiwan | 04
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20014
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇨🇳 Taiwan | 05
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20015
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇨🇳 Taiwan | 06
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20016
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇨🇳 Taiwan | 07
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20017
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇨🇳 Taiwan | 08
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20018
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇸🇬 Singapore | 01
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20021
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇸🇬 Singapore | 02
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20022
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇸🇬 Singapore | 03
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20023
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇸🇬 Singapore | 04
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20024
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇸🇬 Singapore | 05
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20025
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇸🇬 Singapore | 06
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20026
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇸🇬 Singapore | 07
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20027
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇸🇬 Singapore | 08
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20028
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇯🇵 Japan | 01
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20031
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇯🇵 Japan | 02
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20032
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇯🇵 Japan | 03
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20033
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇯🇵 Japan | 04
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20034
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇯🇵 Japan | 05
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20035
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇯🇵 Japan | 06
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20036
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇯🇵 Japan | 07
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20037
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true
  - name: 🇯🇵 Japan | 08
    type: trojan
    server: oss-cn-guangzhou.westdatacloud.xyz
    port: 20038
    password: FEE39A35-9DC2-A583-5A0A-33789A77A466
    sni: v12.kwaicdn.com
    skip-cert-verify: true

proxy-groups:
# 策略组示例请查阅 Clash 项目 README 以使用最新格式：https://github.com/Dreamacro/clash/wiki/configuration

#
# 策略组说明
#
# 「MATCH」类似 Surge 的「Final」，此处用于选择白名单模式(PROXY 策略)和黑名单模式(DIRECT 策略)
#
# 「Streaming」和「StreamingSE」比较好理解，有专用于流媒体的节点就设置到其中，如果没有「StreamingSE」的需求可以连带 Rule 部分一起删掉，「Streaming」需至少保留 Rule，用「PROXY」即可。
#
# 「PROXY」是代理规则策略，它可以指定为某个节点或嵌套一个其他策略组，如：「自动测试」、「Fallback」或「负载均衡」的策略组，关于这 3 个策略组的具体示例可以看官方示例：https://github.com/Dreamacro/clash
#

  # 注意此处的「use」而不是「proxies」，当然也可以不用在此先嵌套一个策略组进行选择，可以直接使用，如
  #
  # # 代理节点选择
  # - name: "PROXY"
  #   type: select
  #   use:
  #     - DuckDuckGo # 嵌套使用订阅节点策略组
  #   proxies:
  #     - Fallback
  #     - 1
  #     - 2
  #     - 3
  #
  # 但如果订阅节点很多选起来就很麻烦，不如先嵌套一个策略组进行手动或自动的选择。

  - name: Proxies
    type: select
    proxies:
      - SG
      - JP
      - TW

  - name: Apple
    type: select
    proxies:
      - DIRECT
      - Proxies
      - SG
      - JP
      - TW

  - name: MicroSoft
    type: select
    proxies:
      - DIRECT
      - Proxies
      - SG
      - JP
      - TW

  - name: Telegram
    type: select
    proxies:
      - Proxies
      - SG
      - JP
      - TW

  - name: YouTube
    type: select
    proxies:
      - Proxies
      - SG
      - JP
      - TW

  - name: Netflix
    type: select
    proxies:
      - Proxies
      - SG
      - JP
      - TW

  - name: AmazonPrimeVideo
    type: select
    proxies:
      - Proxies
      - SG
      - JP
      - TW

  - name: Streaming
    type: select
    proxies:
      - Proxies
      - SG
      - JP
      - TW

  - name: Nintendo
    type: select
    proxies:
      - Proxies
      - SG
      - JP
      - TW

  # 广告
  - name: "Guard"
    type: select
    proxies:
      - REJECT
      - DIRECT

  # 白名单模式 PROXY, 黑名单模式 DIRECT, 不知道别动
  - name: "MATCH"
    type: select
    proxies:
      - Proxies
      - DIRECT

  - name: SG
    type: select
    proxies:
      - 🇸🇬 Singapore | 01
      - 🇸🇬 Singapore | 02
      - 🇸🇬 Singapore | 03
      - 🇸🇬 Singapore | 04
      - 🇸🇬 Singapore | 05
      - 🇸🇬 Singapore | 06
      - 🇸🇬 Singapore | 07
      - 🇸🇬 Singapore | 08

  - name: TW
    type: select
    proxies:
      - 🇨🇳 Taiwan | 01
      - 🇨🇳 Taiwan | 02
      - 🇨🇳 Taiwan | 03
      - 🇨🇳 Taiwan | 04
      - 🇨🇳 Taiwan | 05
      - 🇨🇳 Taiwan | 06
      - 🇨🇳 Taiwan | 07
      - 🇨🇳 Taiwan | 08

  - name: JP
    type: select
    proxies:
      - 🇯🇵 Japan | 01
      - 🇯🇵 Japan | 02
      - 🇯🇵 Japan | 03
      - 🇯🇵 Japan | 04
      - 🇯🇵 Japan | 05
      - 🇯🇵 Japan | 06
      - 🇯🇵 Japan | 07
      - 🇯🇵 Japan | 08

# 关于 Rule Provider 请查阅：https://lancellc.gitbook.io/clash/clash-config-file/rule-provider

rule-providers:
# name: # Provider 名称
#   type: http # http 或 file
#   behavior: classical # 或 ipcidr、domain
#   path: # 文件路径
#   url: # 只有当类型为 HTTP 时才可用，您不需要在本地空间中创建新文件。
#   interval: # 自动更新间隔，仅在类型为 HTTP 时可用

  # AntiAd:
  #   type: http
  #   behavior: domain
  #   url: "https://cdn.jsdelivr.net/gh/privacy-protection-tools/anti-AD@master/anti-ad-clash.yaml"
  #   path: ./ruleset/AntiAd.yaml
  #   interval: 86400

  Advertising:
    type: http
    behavior: classical
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Advertising/Advertising.yaml
    path: ./Rules/Reject/Advertising.yaml
    interval: 86400

  Advertising_Domain:
    type: http
    behavior: domain
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Advertising/Advertising_Domain.yaml
    path: ./Rules/Reject/Advertising_Domain.yaml
    interval: 86400

  BanAD:
    type: http
    behavior: classical
    url: https://cdn.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/BanAD.list
    path: ./Rules/Reject/BanAD.yaml
    interval: 86400  

  Hijacking:
    type: http
    behavior: classical
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Hijacking/Hijacking.yaml
    path: ./Rules/Reject/Hijacking.yaml
    interval: 86400

  Privacy:
    type: http
    behavior: classical
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Privacy/Privacy.yaml
    path: ./Rules/Reject/Privacy.yaml
    interval: 86400

  Privacy_Domain:
    type: http
    behavior: domain
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Privacy/Privacy_Domain.yaml
    path: ./Rules/Reject/Privacy_Domain.yaml
    interval: 86400

  AdguardDNS:
    type: http
    behavior: classical
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/AdGuardSDNSFilter/AdGuardSDNSFilter_Classical.yaml
    path: ./Rules/Reject/AdGuardSDNSFilter_Classical.yaml
    interval: 86400    


  YouTube:
    type: http
    behavior: classical
    path: ./RuleSet/Media/YouTube.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/YouTube/YouTube.yaml
    interval: 86400

  Netflix:
    type: http
    behavior: classical
    path: ./RuleSet/Media/Netflix.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Netflix/Netflix.yaml
    interval: 86400

  Spotify:
    type: http
    behavior: classical
    path: ./RuleSet/Media/Spotify.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Spotify/Spotify.yaml
    interval: 86400

  Disney:
    type: http
    behavior: classical
    path: ./RuleSet/Media/Disney.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Disney/Disney.yaml
    interval: 86400

  AmazonPrimeVideo:
    type: http
    behavior: classical
    path: ./RuleSet/Media/AmazonPrimeVideo.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/AmazonPrimeVideo/AmazonPrimeVideo.yaml
    interval: 86400

  AppleTV:
    type: http
    behavior: classical
    path: ./RuleSet/Media/AppleTV.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/AppleTV/AppleTV.yaml
    interval: 86400

  Telegram:
    type: http
    behavior: classical
    path: ./RuleSet/Social/Telegram.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Telegram/Telegram.yaml
    interval: 86400

  Apple:
    type: http
    behavior: classical
    path: ./RuleSet/Apple/Apple.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Apple/Apple.yaml
    interval: 86400

  Twitter:
    type: http
    behavior: classical
    path: ./RuleSet/Social/Twitter.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Twitter/Twitter.yaml
    interval: 86400

  Instagram:
    type: http
    behavior: classical
    path: ./RuleSet/Social/Instagram.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Instagram/Instagram.yaml
    interval: 86400

  Nintendo:
    type: http
    behavior: classical
    path: ./RuleSet/Game/Nintendo.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Nintendo/Nintendo.yaml
    interval: 86400

  Global:
    type: http
    behavior: classical
    path: ./RuleSet/Global/Proxy.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Global/Global.yaml
    interval: 86400

  China:
    type: http
    behavior: classical
    path: ./RuleSet/China/China.yaml
    url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/China/China.yaml
    interval: 86400

# 规则
rules:
  # 直连和广告拦截
  - RULE-SET,BanAD,Guard
  - RULE-SET,Advertising,Guard
  - RULE-SET,Advertising_Domain,Guard
  - RULE-SET,Hijacking,Guard
  - RULE-SET,Privacy,Guard
  - RULE-SET,Privacy_Domain,Guard
  - RULE-SET,AdguardDNS,Guard

  # YouTube 单独分流
  - RULE-SET,YouTube,YouTube

  # Streaming 国际流媒体服务
  - RULE-SET,Netflix,Netflix
  - RULE-SET,Spotify,Streaming
  - RULE-SET,Disney,Streaming
  - RULE-SET,AppleTV,Streaming
  - RULE-SET,AmazonPrimeVideo,AmazonPrimeVideo

  # Telegram 加速
  - RULE-SET,Telegram,Telegram
  - RULE-SET,Twitter,Telegram
  - RULE-SET,Instagram,Telegram

  # Switch 加速
  - RULE-SET,Nintendo,Nintendo

  # Apple 服务
  - RULE-SET,Apple,Apple

  # Global 全球加速
  - RULE-SET,Global,Proxies

  # China 中国直连
  - RULE-SET,China,DIRECT

  # # Local Area Network 局域网
  # - RULE-SET,LAN,DIRECT

  # GeoIP China
  - GEOIP,CN,DIRECT

  - MATCH,MATCH